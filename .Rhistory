grp <- list (Clade3 = Clade3_nodes$node,
Clade4 = Clade4_nodes$node,
Clade5 = Clade5_nodes$node,
NonThermo_rGCs = rGC_nodes$node,
CeStr_Thermo_rGCs = Thermo_nodes$node
)
speciescolors <- c("NonThermo_rGCs" = "black",
"CeStr_Thermo_rGCs" = "coral",
"Clade3" = "darkorchid",
"Clade4" = "royalblue",
"Clade5" = "palevioletred"
)
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 4, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
ggsave(plot = p2,
filename = paste0(sub('\\..*$', '', basename(treefile)), "_Tree.pdf"),
path = dirname(treefile),
device = cairo_pdf,
width = 12,
height = 10)
p <- ggtree(tree, branch.length='1', layout='rectangular') +
geom_tiplab(size = 4, hjust = 0)
p <- ggtree(tree, branch.length='UFboot', layout='rectangular') +
geom_tiplab(size = 4, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='3', layout='rectangular') +
geom_tiplab(size = 4, hjust = 0)
p <- ggtree(tree, branch.length='SH_aLRT', layout='rectangular') +
geom_tiplab(size = 4, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 4, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 0, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 4, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 1)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 2)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='ellipse') +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species, hjust=1) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species, hjust=0.1) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 1)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species', hjust=1) + aes(color = Species) +
scale_color_manual(values = speciescolors)
p <- ggtree(tree, branch.length='none', layout='rectangular', hjust=1) +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular', hjust=0) +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes((color = Species), hjust=-1) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species), hjust=-1 +
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species, hjust=-1) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)  +
geom_treescale(x=0, y=45)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)  +
geom_treescale(x=0, y=0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)  +
geom_treescale(x=10, y=0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
library(ape)
library(tidyverse)
library(ggtree)
library(treeio)
library(magrittr)
library(rcartocolor)
library(Cairo)
treefile <- file.choose()
tree <- read.iqtree(treefile)
tree_tbl <- as_tibble(tree)
Clade5_nodes <- dplyr::filter(tree_tbl, grepl('Acey|ANCCAN|NAME|HCON|HPOL',label))
Clade4_nodes <- dplyr::filter(tree_tbl, grepl('SRAE|SSTP|Ss|Sr|L596|RSKR',label))
Clade3_nodes <- dplyr::filter(tree_tbl, grepl('EN70|DINM|AgR0|ALUE',label))
rGC_nodes <- dplyr::filter(tree_tbl, grepl('SRAE|SSTP|Ce|DAF',label))
Thermo_nodes <- dplyr::filter(tree_tbl, grepl('Ce-GCY-8|Ce-GCY-18|Ce-GCY-23|Ss|Sr|SSTP_0000846800|SSTP_0000775800|SSTP_0000354300|SRAE_0000007100|SRAE_2000430600|SRAE_X000209000',label))
grp <- list (Clade3 = Clade3_nodes$node,
Clade4 = Clade4_nodes$node,
Clade5 = Clade5_nodes$node,
NonThermo_rGCs = rGC_nodes$node,
CeStr_Thermo_rGCs = Thermo_nodes$node
)
speciescolors <- c("NonThermo_rGCs" = "black",
"CeStr_Thermo_rGCs" = "coral",
"Clade3" = "darkorchid",
"Clade4" = "royalblue",
"Clade5" = "palevioletred"
)
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)  +
geom_treescale(x=10, y=0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
ggsave(plot = p2,
filename = paste0(sub('\\..*$', '', basename(treefile)), "_Tree.pdf"),
path = dirname(treefile),
device = cairo_pdf,
width = 12,
height = 10)
library(ape)
library(tidyverse)
library(ggtree)
library(treeio)
library(magrittr)
library(rcartocolor)
library(Cairo)
treefile <- file.choose()
tree <- read.iqtree(treefile)
tree_tbl <- as_tibble(tree)
Clade5_nodes <- dplyr::filter(tree_tbl, grepl('Acey|ANCCAN|NAME|HCON|HPOL',label))
Clade4_nodes <- dplyr::filter(tree_tbl, grepl('SRAE|SSTP|Ss|Sr|L596|RSKR',label))
Clade3_nodes <- dplyr::filter(tree_tbl, grepl('EN70|DINM|AgR0|ALUE',label))
rGC_nodes <- dplyr::filter(tree_tbl, grepl('SRAE|SSTP|Ce|DAF',label))
Thermo_nodes <- dplyr::filter(tree_tbl, grepl('Ce-GCY-8|Ce-GCY-18|Ce-GCY-23|Ss|Sr|SSTP_0000846800|SSTP_0000775800|SSTP_0000354300|SRAE_0000007100|SRAE_2000430600|SRAE_X000209000',label))
grp <- list (Clade3 = Clade3_nodes$node,
Clade4 = Clade4_nodes$node,
Clade5 = Clade5_nodes$node,
NonThermo_rGCs = rGC_nodes$node,
CeStr_Thermo_rGCs = Thermo_nodes$node
)
speciescolors <- c("NonThermo_rGCs" = "black",
"CeStr_Thermo_rGCs" = "coral",
"Clade3" = "darkorchid",
"Clade4" = "royalblue",
"Clade5" = "palevioletred"
)
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)  +
geom_treescale(x=10, y=0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
ggsave(plot = p2,
filename = paste0(sub('\\..*$', '', basename(treefile)), "_Tree.pdf"),
path = dirname(treefile),
device = cairo_pdf,
width = 12,
height = 10)
library(ape)
library(tidyverse)
library(ggtree)
library(treeio)
library(magrittr)
library(rcartocolor)
library(Cairo)
treefile <- file.choose()
tree <- read.iqtree(treefile)
tree_tbl <- as_tibble(tree)
Clade5_nodes <- dplyr::filter(tree_tbl, grepl('Acey|ANCCAN|NAME|HCON|HPOL',label))
Clade4_nodes <- dplyr::filter(tree_tbl, grepl('SRAE|SSTP|Ss|Sr|L596|RSKR',label))
Clade3_nodes <- dplyr::filter(tree_tbl, grepl('EN70|DINM|AgR0|ALUE',label))
rGC_nodes <- dplyr::filter(tree_tbl, grepl('SRAE|SSTP|Ce|DAF',label))
Thermo_nodes <- dplyr::filter(tree_tbl, grepl('Ce-GCY-8|Ce-GCY-18|Ce-GCY-23|Ss|Sr|SSTP_0000846800|SSTP_0000775800|SSTP_0000354300|SRAE_0000007100|SRAE_2000430600|SRAE_X000209000',label))
grp <- list (Clade3 = Clade3_nodes$node,
Clade4 = Clade4_nodes$node,
Clade5 = Clade5_nodes$node,
NonThermo_rGCs = rGC_nodes$node,
CeStr_Thermo_rGCs = Thermo_nodes$node
)
speciescolors <- c("NonThermo_rGCs" = "black",
"CeStr_Thermo_rGCs" = "coral",
"Clade3" = "darkorchid",
"Clade4" = "royalblue",
"Clade5" = "palevioletred"
)
p <- ggtree(tree, branch.length='none', layout='rectangular') +
geom_tiplab(size = 3, hjust = 0)  +
geom_treescale(x=10, y=0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
ggsave(plot = p2,
filename = paste0(sub('\\..*$', '', basename(treefile)), "_Tree.pdf"),
path = dirname(treefile),
device = cairo_pdf,
width = 12,
height = 10)
help ggtree
?ggtree
p <- ggtree(tree, branch.length='none', layout='circular') +
geom_tiplab(size = 3, hjust = 0)  +
geom_treescale(x=10, y=0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
ggsave(plot = p2,
filename = paste0(sub('\\..*$', '', basename(treefile)), "_Tree.pdf"),
path = dirname(treefile),
device = cairo_pdf,
width = 12,
height = 10)
ggsave(plot = p2,
filename = paste0(sub('\\..*$', '', basename(treefile)), "_Tree.pdf"),
path = dirname(treefile),
device = cairo_pdf,
width = 12,
height = 12)
library(ape)
library(tidyverse)
library(ggtree)
library(treeio)
library(magrittr)
library(rcartocolor)
library(Cairo)
treefile <- file.choose()
tree <- read.iqtree(treefile)
tree_tbl <- as_tibble(tree)
Clade5_nodes <- dplyr::filter(tree_tbl, grepl('Acey|ANCCAN|NAME|HCON|HPOL',label))
Clade4_nodes <- dplyr::filter(tree_tbl, grepl('SRAE|SSTP|Ss|Sr|L596|RSKR',label))
Clade3_nodes <- dplyr::filter(tree_tbl, grepl('EN70|DINM|AgR0|ALUE',label))
rGC_nodes <- dplyr::filter(tree_tbl, grepl('SRAE|SSTP|Ce|DAF',label))
Thermo_nodes <- dplyr::filter(tree_tbl, grepl('Ce-GCY-8|Ce-GCY-18|Ce-GCY-23|Ss|Sr|SSTP_0000846800|SSTP_0000775800|SSTP_0000354300|SRAE_0000007100|SRAE_2000430600|SRAE_X000209000',label))
grp <- list (Clade3 = Clade3_nodes$node,
Clade4 = Clade4_nodes$node,
Clade5 = Clade5_nodes$node,
NonThermo_rGCs = rGC_nodes$node,
CeStr_Thermo_rGCs = Thermo_nodes$node
)
speciescolors <- c("NonThermo_rGCs" = "black",
"CeStr_Thermo_rGCs" = "coral",
"Clade3" = "darkorchid",
"Clade4" = "royalblue",
"Clade5" = "palevioletred"
)
p <- ggtree(tree, branch.length='none', layout='circular') +
geom_tiplab(size = 3, hjust = 0)  +
geom_treescale(x=10, y=0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
ggsave(plot = p2,
filename = paste0(sub('\\..*$', '', basename(treefile)), "_Tree.pdf"),
path = dirname(treefile),
device = cairo_pdf,
width = 12,
height = 12)
ggsave(plot = p2,
filename = paste0(sub('\\..*$', '', basename(treefile)), "_Tree.pdf"),
path = dirname(treefile),
device = cairo_pdf,
width = 12,
height = 12)
ggsave(plot = p2,
filename = paste0(sub('\\..*$', '', basename(treefile)), "_Tree.pdf"),
path = dirname(treefile),
device = cairo_pdf,
width = 14,
height = 12)
ggsave(plot = p2,
filename = paste0(sub('\\..*$', '', basename(treefile)), "_Tree.pdf"),
path = dirname(treefile),
device = cairo_pdf,
width = 14,
height = 14)
library(ape)
library(tidyverse)
library(ggtree)
library(treeio)
library(magrittr)
library(rcartocolor)
library(Cairo)
treefile <- file.choose()
tree <- read.iqtree(treefile)
tree_tbl <- as_tibble(tree)
Clade5_nodes <- dplyr::filter(tree_tbl, grepl('Acey|ANCCAN|NAME|HCON|HPOL',label))
Clade4_nodes <- dplyr::filter(tree_tbl, grepl('SRAE|SSTP|Ss|Sr|L596|RSKR',label))
Clade3_nodes <- dplyr::filter(tree_tbl, grepl('EN70|DINM|AgR0|ALUE',label))
rGC_nodes <- dplyr::filter(tree_tbl, grepl('SRAE|SSTP|Ce|DAF',label))
Thermo_nodes <- dplyr::filter(tree_tbl, grepl('Ce-GCY-8|Ce-GCY-18|Ce-GCY-23|Ss|Sr|SSTP_0000846800|SSTP_0000775800|SSTP_0000354300|SRAE_0000007100|SRAE_2000430600|SRAE_X000209000',label))
grp <- list (Clade3 = Clade3_nodes$node,
Clade4 = Clade4_nodes$node,
Clade5 = Clade5_nodes$node,
NonThermo_rGCs = rGC_nodes$node,
CeStr_Thermo_rGCs = Thermo_nodes$node
)
speciescolors <- c("NonThermo_rGCs" = "black",
"CeStr_Thermo_rGCs" = "coral",
"Clade3" = "darkorchid",
"Clade4" = "royalblue",
"Clade5" = "palevioletred"
)
p <- ggtree(tree, branch.length='none', layout='circular') +
geom_tiplab(size = 3, hjust = 0)  +
geom_treescale(x=10, y=0)
#geom_cladelabel(node = 134, label = "AFD-specific rGCs", align = T, offset = 1,
#offset.text = 1, barsize = 1, angle = -4,
#hjust = 'center', fontsize = 3) +
#geom_hilight(node=86, fill="grey", alpha=.5, extend = 3) +
p2 <- groupOTU(p, grp, 'Species') + aes(color = Species) +
scale_color_manual(values = speciescolors)
p2
ggsave(plot = p2,
filename = paste0(sub('\\..*$', '', basename(treefile)), "_Tree.pdf"),
path = dirname(treefile),
device = cairo_pdf,
width = 14,
height = 14)
library(ape)
library(tidyverse)
library(ggtree)
library(treeio)
library(magrittr)
library(rcartocolor)
library(Cairo)
treefile <- file.choose()
